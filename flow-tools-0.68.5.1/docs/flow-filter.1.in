.\\" auto-generated by docbook2man-spec $Revision: 1.2 $
.TH "FLOW-FILTER" "1" "26 Август 2010" "" ""
.SH NAME
flow-filter \- Filter flows.
.SH SYNOPSIS
.sp
\fBflow-filter\fR [ \fB-hko\fR ]  [ \fB-a\fI src_as_filter\fB\fR ]  [ \fB-A\fI dst_as_filter\fB\fR ]  [ \fB-b\fI big\fB|\fIlittle\fB\fR ]  [ \fB-C\fI comment\fB\fR ]  [ \fB-D\fI dstaddr_filter_name\fB\fR ]  [ \fB-d\fI debug_level\fB\fR ]  [ \fB-e\fI exaddr_filter\fB\fR ]  [ \fB-f\fI acl_fname\fB\fR ]  [ \fB-i\fI input_filter\fB\fR ]  [ \fB-I\fI output_filter\fB\fR ]  [ \fB-p\fI srcport_filter\fB\fR ]  [ \fB-P\fI dstport_filter\fB\fR ]  [ \fB-r\fI ipprot_filter\fB\fR ]  [ \fB-S\fI srcaddr_filter_name\fB\fR ]  [ \fB-t\fI tos_filter\fB\fR ]  [ \fB-T\fI tcp_flags_filter\fB\fR ]  [ \fB-x\fI nexthop_filter_name\fB\fR ]  [ \fB-z\fI z_level\fB\fR ] 
.SH "DESCRIPTION"
.PP
The \fBflow-filter\fR utility will filter flows based on
user selectable criteria. The IP address filters are defined in 
\fIflow.acl\fR or by the filename specified by -f.
.PP
Other filters such as input interface and ports are defined on the
command line. These filters accept range and negation operators, ie
-i1-15 for input interfaces 1 through 15 or -i1,15 for input interfaces
1 and 15, or !1,15 for not input interfaces 1 and 15.
.PP
The syntax is kludgy and needs reworked but works for most applications.
.SH "OPTIONS"
.TP
\fB-a\fI src_as_filter\fB\fR
Source AS filter, ie -a159 to permit Autonomous System 159.
.TP
\fB-A\fI dst_as_filter\fB\fR
Destination AS filter, ie -A159,3112 to permit Autonomous Systems 159 and 3112.
.TP
\fB-b\fI big\fB|\fIlittle\fB\fR
Byte order of output.
.TP
\fB-C\fI Comment\fB\fR
Add a comment. 
.TP
\fB-d\fI debug_level\fB\fR
Enable debugging.
.TP
\fB-D\fI dstaddr_filter_name\fB\fR
Destination IP address filter. This is the name or number of a standard
access list defined in \fIflow.acl\fR or the file specified
by -f.
.TP
\fB-e\fI exaddr_filter\fB\fR
Exporter IP address filter. One exporter address can be filtered.
.TP
\fB-f\fI acl_fname\fB\fR
Access list filename. Defaults to \fIflow.acl\fR\&.
.TP
\fB-h\fR
Display help.
.TP
\fB-i\fI input_filter\fB\fR
Input interface filter, ie -i0 to permit traffic from interface 0.
.TP
\fB-k\fR
Keep time from input.
.TP
\fB-I\fI output_filter\fB\fR
Output interface filter, ie -I0 to permit traffic to interface 0.
.TP
\fB-o\fR
Logical OR instead of AND filters.
.TP
\fB-p\fI srcport_filter\fB\fR
Source port filter, ie -p80 to only permit source port 80.
.TP
\fB-P\fI dstport_filter\fB\fR
Destination port filter, ie -P80,8080 to permit destination ports 80 and 8080.
.TP
\fB-r\fI ipprot_filter\fB\fR
IP Protocol filter, ie -r6 to only permit TCP traffic.
.TP
\fB-S\fI srcaddr_filter_name\fB\fR
Source IP address filter. This is the name or number of a standard
access list defined in \fIflow.acl\fR or the file
specified by -f.
.TP
\fB-t\fI tos_filter\fB\fR
ToS bits filter. An optional mask is available which is applied to
the tos field before comparing to the filter list. For example to
match a tos bit pattern of 101xxxxx use 0xA0/0xE0.
.TP
\fB-T\fI tcp_flags_filter\fB\fR
TCP bits filter. An optional mask is available which is applied to
the TCP flags field before comparing to the filter list. For example to
match a flows with the SYN bit set use 0x2/0x2.
.TP
\fB-x\fI nexthop_filter_name\fB\fR
NextHop IP address filter. This is the name or number of a standard
access list defined in \fIflow.acl\fR or the file
specified by -f.
.TP
\fB-z\fI z_level\fB\fR
Configure compression level to \fI z_level\fR\&. 0 is
disabled (no compression), 9 is highest compression.
.SH "EXAMPLES"
.PP
.PP
Print all traffic with a destination port of 80.
.PP
\fBflow-cat /flows/krc4 | flow-filter -P80 | flow-print\fR
.PP
.PP
Print all traffic with with source IP 10.0.0.1. Populate
\fIflow.acl\fR with
ip access-list standard badguy permit host 10.0.0.1
.PP
\fBflow-cat /flows/krc4 | flow-filter -Sbadguy | flow-print\fR
.PP
.PP
Report all destinations that IP 10.0.0.1 has sent traffic to. Sort by
octets. Populate \fIflow.acl\fR with
ip access-list standard badguy permit host 10.0.0.1
.PP
\fBflow-cat /flows/krc4 | flow-filter -Sbadguy | flow-stat -f8 -S2\fR
.SH "BUGS"
.PP
Extended access lists are not fully implemented.
The command line filter syntax is a kludge.
.SH "NOTES"
.PP
Use flow-nfilter.
.SH "AUTHOR"
.PP
Mark Fullmer 
<maf@splintered.net>
.SH "SEE ALSO"
.PP
\fBflow-tools\fR(1)
